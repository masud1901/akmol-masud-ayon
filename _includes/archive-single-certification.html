{% include base_path %}

{% if post.id %}
{% assign title = post.title | markdownify | remove: "<p>" | remove: "</p>" %}
{% else %}
{% assign title = post.title %}
{% endif %}

<div class="{{ include.type | default: 'list' }}__item">
    <article class="archive__item archive__item--certification" itemscope
        itemtype="http://schema.org/EducationalOccupationalCredential">

        {%- comment -%} Certificate image/thumbnail {%- endcomment -%}
        {% if post.certificate_image %}
        <div class="archive__item-teaser archive__item-teaser--certification">
            {% if post.credential_url %}
            <a href="{{ post.credential_url }}" target="_blank" rel="noopener noreferrer">
                <img src="{{ post.certificate_image }}" alt="{{ title }} Certificate" loading="lazy">
                <div class="certificate-overlay">
                    <i class="fas fa-certificate" aria-hidden="true"></i>
                    <span>View Certificate</span>
                </div>
            </a>
            {% else %}
            <img src="{{ post.certificate_image }}" alt="{{ title }} Certificate" loading="lazy">
            {% endif %}
        </div>
        {% else %}
        {%- comment -%} Fallback certification badge/icon {%- endcomment -%}
        <div class="archive__item-certification-badge">
            {% if post.status == "completed" %}
            <i class="fas fa-certificate" aria-hidden="true"></i>
            {% elsif post.status == "in_progress" %}
            <i class="fas fa-hourglass-half" aria-hidden="true"></i>
            {% else %}
            <i class="fas fa-award" aria-hidden="true"></i>
            {% endif %}
        </div>
        {% endif %}

        <h2 class="archive__item-title" itemprop="name">
            <a href="{{ base_path }}{{ post.url }}" rel="permalink">{{ title }}</a>
        </h2>

        {% if post.issuer %}
        <p class="archive__item-issuer" itemprop="sourceOrganization">
            <i class="fa fa-university" aria-hidden="true"></i> {{ post.issuer }}
        </p>
        {% endif %}

        {% if post.date %}
        <p class="page__meta">
            <i class="fa fa-calendar" aria-hidden="true"></i>
            {% if post.status == "in_progress" %}
            Expected: {{ post.date | date: "%B %Y" }}
            {% else %}
            Completed: {{ post.date | date: "%B %Y" }}
            {% endif %}
        </p>
        {% endif %}

        {% if post.status %}
        <p class="archive__item-status">
            {% if post.status == "completed" %}
            <span class="status-badge status-badge--completed">Completed</span>
            {% elsif post.status == "in_progress" %}
            <span class="status-badge status-badge--in-progress">In Progress</span>
            {% endif %}
        </p>
        {% endif %}

        {% if post.excerpt %}
        <p class="archive__item-excerpt" itemprop="description">{{ post.excerpt | markdownify }}</p>
        {% endif %}

        {% if post.credential_url %}
        <p class="archive__item-credential">
            <a href="{{ post.credential_url }}" target="_blank" rel="noopener noreferrer">
                <i class="fa fa-external-link" aria-hidden="true"></i> View Certificate
            </a>
        </p>
        {% endif %}

    </article>
</div>